<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>RYD STORE OFFICIAL</title>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&display=swap');
        body { font-family: 'Inter', sans-serif; background-color: #1a2233; color: white; -webkit-tap-highlight-color: transparent; }
        .bg-dark-main { background-color: #1a2233; }
        .bg-card { background-color: #252f44; border: 1px solid #333f58; }
        .btn-primary { background-color: #3b82f6; transition: 0.2s; }
        .btn-primary:active { transform: scale(0.95); background-color: #2563eb; }
        .input-style { background-color: #252f44; border: 1px solid #333f58; color: white; border-radius: 12px; }
        .modal-content { background: #ffffff; border-radius: 30px 30px 0 0; color: #1a2233; }
        .icon-circle { width: 50px; height: 50px; border-radius: 14px; display: flex; align-items: center; justify-content: center; margin-bottom: 8px; font-weight: bold; font-size: 10px; color: white; text-align: center; line-height: 1; }
    </style>
</head>
<body>

<div id="app" class="max-w-md mx-auto min-h-screen shadow-2xl flex flex-col relative overflow-hidden">
    <div class="p-20 text-center animate-pulse">Loading System...</div>
</div>

<div id="modalProduk" class="fixed inset-0 bg-black/70 z-50 flex items-end hidden" onclick="tutupModal()">
    <div class="modal-content w-full p-8 animate-bounce-in" onclick="event.stopPropagation()">
        <div class="w-12 h-1.5 bg-gray-200 rounded-full mx-auto mb-6"></div>
        <h3 id="modalTitle" class="text-xl font-bold mb-6">Pilih Nominal</h3>
        <div id="listProduk" class="grid grid-cols-2 gap-4 max-h-[60vh] overflow-y-auto pb-10"></div>
    </div>
</div>

<script>
    const WA_ADMIN = "6285881934739";
    const PROFIT = 2000;
    const firebaseConfig = {
        apiKey: "AIzaSyCEeF0D3RB5uthkMKx5rkSTEYii-7Pp0KM",
        authDomain: "riyadistore3.firebaseapp.com",
        databaseURL: "https://riyadistore3-default-rtdb.asia-southeast1.firebasedatabase.app",
        projectId: "riyadistore3",
        storageBucket: "riyadistore3.firebasestorage.app",
        messagingSenderId: "28764528472",
        appId: "1:28764528472:web:941e615ef35d62b4724f2d"
    };

    if (!firebase.apps.length) firebase.initializeApp(firebaseConfig);
    const db = firebase.database();
    let userAktif = localStorage.getItem('ryd_user');

    function view(html) { document.getElementById('app').innerHTML = html; }

    // HALAMAN LOGIN PERSIS GAMBAR
    function pageLogin() {
        view(`
            <div class="p-8 pt-20 flex-1">
                <div class="w-24 h-24 bg-gradient-to-br from-blue-500 to-blue-900 rounded-[2.5rem] mx-auto mb-6 flex items-center justify-center shadow-2xl">
                    <span class="text-5xl font-black italic">R</span>
                </div>
                <h1 class="text-2xl font-bold text-center mb-2 tracking-tight">RYD STORE OFFICIAL</h1>
                <p class="text-center text-gray-400 text-sm mb-12 uppercase tracking-widest font-bold italic">2 Justtrai Akun</p>
                
                <div class="space-y-4">
                    <div>
                        <label class="text-xs text-gray-400 ml-1 mb-1 block">Username</label>
                        <input id="l_u" type="text" placeholder="Masukkan Username" class="input-style w-full p-4 outline-none">
                    </div>
                    <div>
                        <label class="text-xs text-gray-400 ml-1 mb-1 block">Password</label>
                        <input id="l_p" type="password" placeholder="Masukkan Password" class="input-style w-full p-4 outline-none">
                    </div>
                    <button onclick="doLogin()" class="w-full btn-primary p-4 rounded-xl font-bold mt-6 shadow-lg shadow-blue-500/20">Do Login</button>
                    <button onclick="pageRegister()" class="w-full bg-white/5 p-4 rounded-xl font-bold mt-2 text-gray-300">Daftar Member</button>
                </div>
            </div>
        `);
    }

    // HALAMAN REGISTER
    function pageRegister() {
        view(`
            <div class="p-8 pt-20">
                <h2 class="text-4xl font-black mb-2 italic">Registtrai Akun</h2>
                <h2 class="text-2xl font-bold text-blue-500 mb-6 uppercase tracking-tighter">RYADSTIRE5</h2>
                <p class="text-gray-400 text-xs leading-relaxed mb-8">Pendaftaran member resmi RYD Store. Nikmati layanan topup termurah dan tercepat langsung dari aplikasi.</p>
                
                <div class="space-y-4">
                    <input id="r_u" type="text" placeholder="Username Baru" class="input-style w-full p-4 outline-none">
                    <input id="r_p" type="password" placeholder="Password Baru" class="input-style w-full p-4 outline-none">
                    <button onclick="doRegister()" class="w-full btn-primary p-4 rounded-xl font-bold shadow-lg">Daftar Member</button>
                    <button onclick="pageLogin()" class="w-full text-gray-500 font-bold text-sm mt-4">Sudah punya akun? Login</button>
                </div>
            </div>
        `);
    }

    // DASHBOARD PERSIS GAMBAR REFERENSI
    function pageDashboard() {
        db.ref('users/' + userAktif.toLowerCase()).on('value', (s) => {
            const data = s.val();
            if(!data) return pageLogin();
            const saldo = Number(data.saldo || 0);

            view(`
                <div class="p-6">
                    <div class="flex justify-between items-center mb-8">
                        <div>
                            <p class="text-xs text-gray-400 uppercase font-bold tracking-widest">User Aktif</p>
                            <h2 class="text-xl font-bold">@${userAktif}</h2>
                        </div>
                        <button onclick="logout()" class="bg-red-500/10 text-red-500 p-2 px-4 rounded-lg text-xs font-bold">LOGOUT</button>
                    </div>

                    <div class="bg-gradient-to-r from-blue-600 to-blue-800 p-6 rounded-[2rem] shadow-xl mb-8 border border-blue-400/20">
                        <p class="text-[10px] font-bold opacity-70 uppercase tracking-widest mb-1">Total Saldo Member</p>
                        <h2 class="text-4xl font-black italic tracking-tighter">Rp ${saldo.toLocaleString('id-ID')}</h2>
                    </div>

                    <div class="bg-white rounded-[2rem] p-6 text-gray-800">
                        <h3 class="font-bold mb-4 uppercase text-xs tracking-widest text-gray-400">Pilih Produk</h3>
                        <div class="grid grid-cols-4 gap-4 mb-8">
                            <div onclick="bukaModal('Telkomsel', 'pulsa')" class="flex flex-col items-center">
                                <div class="icon-circle bg-red-600">TELKOM</div>
                                <span class="text-[9px] font-bold">Telkomsel</span>
                            </div>
                            <div onclick="bukaModal('XL', 'pulsa')" class="flex flex-col items-center">
                                <div class="icon-circle bg-blue-700">XL.png</div>
                                <span class="text-[9px] font-bold">XL Axiata</span>
                            </div>
                            <div onclick="bukaModal('Free Fire', 'game')" class="flex flex-col items-center">
                                <div class="icon-circle bg-orange-500">ff</div>
                                <span class="text-[9px] font-bold">Free Fire</span>
                            </div>
                            <div onclick="bukaModal('Tri', 'pulsa')" class="flex flex-col items-center">
                                <div class="icon-circle bg-pink-600">Tri</div>
                                <span class="text-[9px] font-bold">Tri (3)</span>
                            </div>
                        </div>

                        <h3 class="font-bold mb-4 uppercase text-xs tracking-widest text-gray-400">List Produk</h3>
                        <div class="grid grid-cols-4 gap-4">
                            <div onclick="bukaModal('DANA', 'ewallet')" class="flex flex-col items-center">
                                <div class="icon-circle bg-blue-500 font-black">DANA</div>
                                <span class="text-[9px] font-bold">DANA</span>
                            </div>
                            <div onclick="bukaModal('GoPay', 'ewallet')" class="flex flex-col items-center">
                                <div class="icon-circle bg-emerald-600 font-black">GoPay</div>
                                <span class="text-[9px] font-bold">GoPay</span>
                            </div>
                            <div onclick="bukaModal('PUBG', 'game')" class="flex flex-col items-center">
                                <div class="icon-circle bg-yellow-600 font-black">PUBG</div>
                                <span class="text-[9px] font-bold">PUBG M</span>
                            </div>
                            <div onclick="bukaModal('OVO', 'ewallet')" class="flex flex-col items-center">
                                <div class="icon-circle bg-purple-700 font-black">OVO</div>
                                <span class="text-[9px] font-bold">OVO</span>
                            </div>
                        </div>
                    </div>
                    
                    <button onclick="window.location.href='https://wa.me/${WA_ADMIN}?text=Isi Saldo @${userAktif}'" class="w-full bg-blue-500 mt-6 p-4 rounded-2xl font-bold shadow-lg shadow-blue-500/20 italic uppercase tracking-tighter">Isi Saldo Member</button>
                </div>
            `);
        });
    }

    function bukaModal(name, tipe) {
        document.getElementById('modalTitle').innerText = name;
        const list = document.getElementById('listProduk');
        list.innerHTML = "";
        let nominals = [5000, 10000, 20000, 50000, 100000];
        if(tipe === 'game') nominals = [86, 172, 257, 706];

        nominals.forEach(nom => {
            const harga = nom + PROFIT;
            list.innerHTML += `
                <div onclick="beli('${name}', '${nom}', ${harga})" class="bg-gray-50 p-4 rounded-2xl border border-gray-100 text-center active:bg-gray-200">
                    <p class="text-xs font-bold text-gray-400 uppercase">${tipe}</p>
                    <p class="text-xl font-black text-gray-800">${nom.toLocaleString()}</p>
                    <p class="text-xs font-bold text-blue-600">Rp ${harga.toLocaleString()}</p>
                </div>
            `;
        });
        document.getElementById('modalProduk').classList.remove('hidden');
    }

    function tutupModal() { document.getElementById('modalProduk').classList.add('hidden'); }

    function beli(op, nom, harga) {
        const msg = `Order Produk:*%0A- Item: *${op}*%0A- Nominal: *${nom}*%0A- Harga: *Rp ${harga.toLocaleString()}*%0A- Akun: *${userAktif}*`;
        window.location.href = `https://wa.me/${WA_ADMIN}?text=${msg}`;
    }

    function doLogin() {
        const u = document.getElementById('l_u').value.toLowerCase().trim();
        const p = document.getElementById('l_p').value;
        if(!u || !p) return alert("Lengkapi data!");
        db.ref('users/' + u).once('value', s => {
            if(s.exists() && s.val().password === p) {
                userAktif = u; localStorage.setItem('ryd_user', u); pageDashboard();
            } else { alert("Data Salah!"); }
        });
    }

    function doRegister() {
        const u = document.getElementById('r_u').value.toLowerCase().trim();
        const p = document.getElementById('r_p').value;
        if(u.length < 3) return alert("Username min 3 huruf!");
        db.ref('users/' + u).set({ password: p, saldo: 0 }).then(() => {
            alert("Berhasil!"); pageLogin();
        });
    }

    function logout() { localStorage.removeItem('ryd_user'); location.reload(); }

    if(userAktif) pageDashboard(); else pageLogin();
</script>
</body>
</html>
